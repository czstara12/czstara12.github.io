---
title: ESP串口透传
date: 2023-11-30 13:12:36
categories:
- 嵌入式
tags:
- 串口
---

## ESP32/ESP8266串口透传

好用的蓝牙模块涨价 esp模块十分便宜

而盗版蓝牙模块连接稳定性不佳 经常会断连 还会有严重的电磁干扰(如果你的实验室有调智能车的选手而且他使用了无线串口图传的模块)

<!-- more -->

1. 使用更为成熟,更加好用的WIFI+TCP连接.(有什么模块能比穿墙路由器的信号功率还大?+TCP/IP丢包重发的特性)

2. 使用ESP官方提供的AT固件,经过大量工程师和产品验证,避免自己编写代码出现bug.
3. 本文使用最便宜的ESP-01s模块作为范例

![ESP-01S][ESP-01S]

## 基本操作

### 刷写固件

*你也可以在[这里](https://espressif-docs.readthedocs-hosted.com/projects/esp-at/zh-cn/release-v2.2.0.0_esp8266/Get_Started/Downloading_guide.html)参考官方教程*

### 下载

在[这里](https://espressif-docs.readthedocs-hosted.com/projects/esp-at/zh-cn/release-v2.2.0.0_esp8266/AT_Binary_Lists/ESP32_AT_binaries.html)下载对应模块的固件

在[这里](https://www.espressif.com/zh-hans/support/download/other-tools)下载ESP的Flash 下载工具

注:ESP公司的芯片有多个系列,分为ESP32 ESP32S2 ESP32S3 ESP32C2 ESP32C3等.

据我所知,只要你给芯片接上足够大的flash,一个系列芯片的固件可以通刷,就像STM32C8和STM32RB固件可以互刷一样,所以你只需要注意你购买的模块的flash容量和使用的核心芯片系列下载对应的固件即可.

[这是我使用的固件](https://github.com/czstara12/esp-at/actions/runs/7152062309),因为ESP官方的固件没有使用ESP-01s引出的管脚作为AT数据接口,所以对官方固件进行小小的修改,将固件使用的io口设置到原本的默认串口上.这样带来的一个问题是在模块启动的时候会输出无关的日志信息,且无法关闭,只需要在使用的时候控制EN脚重置模块配合屏蔽掉串口信息即可.

直接下载[链接](https://github.com/czstara12/esp-at/suites/18900939376/artifacts/1103665107)

### 硬件连接

![2019-12-12_135802.png](https://pic.idzd.top/usr/uploads/2019/12/1215313008.png)

- 3V3 —— 3V3
- GND —— GND
- RX —— TXD
- TX —— RXD
- IO0 —— GND

ESP-01S的`GPIO0`是工作模式选择：悬空：Flash Boot，工作模式； 下拉：UART DownLoad，下载模式；

所以在上电时让ESP-01S进入烧录模式,这里有一个小窍门,等到下载时再接上3V3,先接上其余四根线就可以让模块进入下载模式.

### 烧录

下载好之后,请使用factory(工厂量产)的固件,设置量比较少.

打开工具,选择你使用的模块

![image-20231209194120105](../img/image-20231209194120105.png)

按OK进入后,选择解压出来的factory固件bin文件,设置连接上的COM口和波特率(决定你的下载速度 下载失败可以考虑降低改制),其余按图片设置.

![image-20231209194344833](../img/image-20231209194344833.png)

按下START,接上模块3V3线,等待进度条走完,没有出现红色报错即为成功.

### 测试

要求使用电脑和模块使用同一个局域网

打开一个网络调试软件

设置主机协议类型,检查ip地址,设置开放端口示例如下:

![image-20231209205748037](../img/image-20231209205748037.png)

使用串口工具设置:

连接WiFi

```
AT+CWJAP="WIFI名","WIFI密码"
```

建立连接,用上面软件里设置的IP和端口

```
AT+CIPSTART="TCP","目标IP",目标端口
```

设置WiFi透传传输模式

```
AT+CIPMODE=1
```

进入 Wi-Fi 透传模式

```
AT+CIPSEND
```

发送一些消息,检查是否成功接收.

### 设置

去掉IO0 —— GND这根线,将模块连接到电脑上,依次设置:

WIFI和密码

```
AT+CWJAP="WIFI名","WIFI密码"
```

设置开机启动透传

```
AT+SAVETRANSLINK=1,"192.168.31.210",8080,"TCP"
```

# 使用姿势

## 模块-模块

未测试 待补充

## 模块-路由器-电脑

在设置开机启动透传命令里设置好网络调试助手的信息即可自动连接

[ESP-01S]:data:image/jpeg;base64,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